

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>基本语法 &mdash; RapydScript 1.0 文档</title>
  <meta name="description" content="使用Python编写JavaScript代码;将Python代码转换成JavaScript">
  <meta name="keywords" content="JavaScript, RapydScript, Python, Coffescript, Complier, Web">
  

  
  

  
  <link href='http://fonts.useso.com/css?family=Open+Sans:300,400,600&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="RapydScript 1.0 文档" href="index.html"/>
        <link rel="next" title="类" href="class.html"/>
        <link rel="prev" title="开始编程" href="start.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-logo">
        <a href="#"><img class="logo" src="_static/rs_logo_tiny_med.png"></a>
        <a class="title" href="index.html"> RapydScript</a>
      </div>
      <div class="wy-side-nav-search">
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="搜索..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">RapydScript的介绍</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#id1">RapydScript是什么</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#id2">它的特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#id3">社区</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#id4">链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">安装与使用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#id2">安装编译器</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#id3">编译代码</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html">开始编程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#id3">简单的例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#id4">在页面中调用</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#api">使用外部的API</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">基本语法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tuple">元组 (tuple)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#list">列表 (List)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">循环</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id17">其它惯用法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#js">嵌入JS代码</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="class.html">类</a><ul>
<li class="toctree-l2"><a class="reference internal" href="class.html#rapydscript">RapydScript的类</a></li>
<li class="toctree-l2"><a class="reference internal" href="class.html#id7">外部类</a></li>
<li class="toctree-l2"><a class="reference internal" href="class.html#id8">方法与对象的绑定</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module.html">模块和库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="module.html#id3">模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="module.html#id6">代码库</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scope.html">变量的作用域</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scope.html#id3">局部和全局作用域</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope.html#globalnonlocal">global和nonlocal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="except.html">异常处理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="except.html#try-except">try/except</a></li>
<li class="toctree-l2"><a class="reference internal" href="except.html#id3">捕获特定异常</a></li>
<li class="toctree-l2"><a class="reference internal" href="except.html#id4">自定义的异常类</a></li>
<li class="toctree-l2"><a class="reference internal" href="except.html#try-except-finally">try/except/finally</a></li>
<li class="toctree-l2"><a class="reference internal" href="except.html#id7">抛出异常</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advance.html">高级话题</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advance.html#id3">浏览器兼容性</a></li>
<li class="toctree-l2"><a class="reference internal" href="advance.html#id4">编码惯例</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quriks.html">编程琐事</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quriks.html#id3">注意事项</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
      <div class="wy-side-author">
        rapydscript.cn
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">RapydScript</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>基本语法</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://github.com/adousen/RapydScript-Doc-zh_CN" rel="nofollow"> View source on github</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id26">基本语法</a><a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="contents topic" id="id2">
<p class="topic-title first">目录</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id26">基本语法</a><ul>
<li><a class="reference internal" href="#tuple" id="id27">元组 (tuple)</a><ul>
<li><a class="reference internal" href="#id3" id="id28">元组解包与推断</a></li>
<li><a class="reference internal" href="#id4" id="id29">元组打包</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list" id="id30">列表 (List)</a><ul>
<li><a class="reference internal" href="#list-comprehension" id="id31">列表推导式 (list comprehension)</a></li>
<li><a class="reference internal" href="#id5" id="id32">列表的上限</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6" id="id33">循环</a><ul>
<li><a class="reference internal" href="#for" id="id34">for循环</a></li>
<li><a class="reference internal" href="#while" id="id35">while循环</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7" id="id36">函数</a><ul>
<li><a class="reference internal" href="#id8" id="id37">匿名函数</a></li>
<li><a class="reference internal" href="#id9" id="id38">内联函数</a></li>
<li><a class="reference internal" href="#id10" id="id39">参数魔法</a><ul>
<li><a class="reference internal" href="#id11" id="id40">函数可选参数</a></li>
<li><a class="reference internal" href="#def-func-args" id="id41">变长参数列表 (<tt class="docutils literal"><span class="pre">def</span> <span class="pre">func(*args)</span></tt>)</a></li>
<li><a class="reference internal" href="#func-args-list" id="id42">分配参数 (<tt class="docutils literal"><span class="pre">func(*args_list)</span></tt>)</a></li>
<li><a class="reference internal" href="#kwargs" id="id43">关键字参数(<tt class="docutils literal"><span class="pre">**kwargs</span></tt>)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16" id="id44">函数修饰符</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id17" id="id45">其它惯用法</a><ul>
<li><a class="reference internal" href="#id18" id="id46">列表的操作</a></li>
<li><a class="reference internal" href="#id19" id="id47">关键字</a></li>
<li><a class="reference internal" href="#id20" id="id48">操作符</a></li>
<li><a class="reference internal" href="#id23" id="id49">三元条件表达式</a></li>
<li><a class="reference internal" href="#id24" id="id50">链式代码块</a><ul>
<li><a class="reference internal" href="#javascript" id="id51">JavaScript风格链式操作</a></li>
<li><a class="reference internal" href="#python" id="id52">Python风格链式操作</a></li>
<li><a class="reference internal" href="#id25" id="id53">while循环的增强特性</a></li>
</ul>
</li>
<li><a class="reference internal" href="#print" id="id54">输出语句print()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#js" id="id55">嵌入JS代码</a></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="tuple">
<h2><a class="toc-backref" href="#id27">元组 (tuple)</a><a class="headerlink" href="#tuple" title="永久链接至标题">¶</a></h2>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id28">元组解包与推断</a><a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>与Python一样，RapydScript支持元组 打包(packing)以及解包(unpacking)时的推断与分配。</p>
<div class="line-block">
<div class="line"><strong>注：</strong> python对元组、列表、字典等序列或可迭代对象均支持解包操作。</div>
<div class="line"><br /></div>
</div>
<p>虽然推断/隐含通常来说不太好，但有些时候可以让代码变得简洁。并且，它符合 <a class="reference external" href="http://blog.csdn.net/gzlaiyonghao/article/details/2151918">Python之禅</a> 中所描述的指导原则：&#8217;beautiful&#8217; takes priority over &#8216;explicit&#8217;（美的优先级高于显）。</p>
<p>比如，若要交换两个变量，下面的代码看起来要比显式地定义一个临时变量要简洁：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># 先将等号右侧两个变量打包成新的元组(b, a)</span>
<span class="c"># 赋值时再将其解包并分别赋给两个新的变量a和b</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
</pre></div>
</div>
<p>同样，如果一个函数可以返回多个值，那么一个简单的语句就可以将其分配给多个变量：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fun</span><span class="p">()</span>
</pre></div>
</div>
<p>而不是:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tmp</span> <span class="o">=</span> <span class="n">fun</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>由于JavaScript不支持元组，因此RapydScript在背后，实际使用的是JavaScript数组来做元组打包和解包操作，但实现了与在Python中一样的功能。注意，只有在将元组分配给多个参数时，解包操作才会发生：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fun</span><span class="p">()</span>     <span class="c"># 做了解包操作</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">fun</span><span class="p">()</span>         <span class="c"># 未解包, tmp将会存储一组元素</span>
</pre></div>
</div>
<p>在for循环中（参见 <a class="reference external" href="#for">for循环</a> ），也可以做解包操作：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="s">&#39;: &#39;</span><span class="o">+</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> enumerate()是一个内建的全局函数，用于迭代产生值。在python中，所有元组、列表、字典等序列或可迭代对象均可以被enumerate操作。</div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id29">元组打包</a><a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>元组打包操作是元组解包的反向操作。它发生在对成组元素将进行分配的时候，而不是具体怎么被分配的过程中。比如，它可以发生在变量赋值和函数返回值的时候：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">fun</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="c"># 实际上返回的是元组 (1, 2, 3)</span>
</pre></div>
</div>
<p>总的来说，元组打包与解包操作基本只是一个语法糖，它删除了分配逻辑中让程序显得丑陋的代码。比如，在本节开始处，交换两个变量值的操作的等价代码如下：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="list">
<h2><a class="toc-backref" href="#id30">列表 (List)</a><a class="headerlink" href="#list" title="永久链接至标题">¶</a></h2>
<div class="section" id="list-comprehension">
<h3><a class="toc-backref" href="#id31">列表推导式 (list comprehension)</a><a class="headerlink" href="#list-comprehension" title="永久链接至标题">¶</a></h3>
<p>RapydScript的列表与JavaScript中的数组在概念上是一样的，都是可变的序列。不过，这里的列表有一些特殊的操作和用法，它们与Python中列表的特性很相像。</p>
<p>RapydScript同样支持列表推导式，使用的语法和Python相同。</p>
<div class="line-block">
<div class="line"><strong>注：</strong> 列表推导式，就是利用列表创建新的列表，类似数学中的集合推导式</div>
<div class="line"><br /></div>
</div>
<p>例如，你不必像下面这样写：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># 对range范围中的每个数求平方</span>
<span class="c"># 如果不是3的倍数，就将其添加到列表myArray中</span>
<span class="n">myArray</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span><span class="o">*</span><span class="n">index</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">myArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="o">*</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
<p>这段代码可以写成：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> range函数用于创建一个指定上下限的序列（列表），产生的序列包含下限的值，但不包含上限。</div>
<div class="line"><br /></div>
</div>
<p><strong>提示：</strong> 这一小节有部分内容已经移除，原因是其中的一些怪异的部分在一些旧的Python编译器中并没有。当前实现的列表推导式与普通循环的工作方式差不多。</p>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id32">列表的上限</a><a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>与在Pyhton中一样，RapydScript也有一个 range() 函数。虽然它很强大，但只是看代码的话，会发现它生成的结果并不明显。这有点让人难受，因为要花数秒钟来阅读代码，还要记住它不包含上限，这有损代码的流畅。作为补救，RapydScript从LiveScript中借用了 <tt class="docutils literal"><span class="pre">to/til</span></tt> 操作符（它也是Ruby中 <tt class="docutils literal"><span class="pre">list[../...]</span></tt> 分片操作的易读版本）。</p>
<p>比如，下面的4行代码具有相同的作用：</p>
<div class="highlight-python"><div class="highlight"><pre>a = [3 to 8]
a = [3 til 9]
a = range(3, 9)
a = [3, 4, 5, 6, 7, 8]
</pre></div>
</div>
<p>你还可以在循环中使用这种形式的序列：</p>
<div class="highlight-python"><div class="highlight"><pre>for i in [1 to 5]:
    print(i)
</pre></div>
</div>
<p>或者在列表推导式中使用：</p>
<div class="highlight-python"><div class="highlight"><pre>[i*i for i in [1 to 6] if i%2 == 0]
</pre></div>
</div>
<p>在编译时，<tt class="docutils literal"><span class="pre">to/til</span></tt> 语句将会转换成 range()。因此，上限和下限甚至可以使用变量或表达式。</p>
<div class="highlight-python"><div class="highlight"><pre>num = 5
rng = [num to num * 2]
</pre></div>
</div>
<p>由于 <tt class="docutils literal"><span class="pre">to/til</span></tt> 操作符的优先级严格低于算术操作符，因此算术表达式的括号是可选的。</p>
</div>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id33">循环</a><a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<div class="section" id="for">
<h3><a class="toc-backref" href="#id34">for循环</a><a class="headerlink" href="#for" title="永久链接至标题">¶</a></h3>
<p>RapydScript中的循环工作方式与在Python中很相像，但与JavaScript很不相同。比如，你不能使用 <tt class="docutils literal"><span class="pre">for(i=0;i&lt;max;i++)</span></tt> 这样的语法。不过，你可以在一个序列上使用 <tt class="docutils literal"><span class="pre">for</span> <span class="pre">...</span> <span class="pre">in</span></tt> 语法。并且，你不用担心转换的JavaScript代码会添加一些额外不相关的东西。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">animals</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;cat&#39;</span><span class="p">,</span> <span class="s">&#39;dog&#39;</span><span class="p">,</span> <span class="s">&#39;mouse&#39;</span><span class="p">,</span> <span class="s">&#39;horse&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">animal</span> <span class="ow">in</span> <span class="n">animals</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;I have a &#39;</span><span class="o">+</span><span class="n">animal</span><span class="p">)</span>
</pre></div>
</div>
<p>如果想在循环中使用序列中元素的索引，你可以使用 enumerate() 函数：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">animal</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">animals</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;index:&quot;</span><span class="o">+</span><span class="n">index</span><span class="p">,</span> <span class="s">&quot;animal:&quot;</span><span class="o">+</span><span class="n">animal</span><span class="p">)</span>
</pre></div>
</div>
<p>与Python相同，如果只是想根据序列中元素的索引进行操作，你可使用到 range() 函数：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">animals</span><span class="p">)):</span>    <span class="c"># 或者用 range(animals.length)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;animal &quot;</span><span class="o">+</span><span class="n">index</span><span class="o">+</span><span class="s">&quot; is a &quot;</span><span class="o">+</span><span class="n">animals</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
<p>在编译成JavaScript基本语法的过程中，RapydScript会尽可能帮你自动对循环进行优化。所以，虽然你不能直接调用JavaScript的for语句，但也不会失去太多什么。</p>
</div>
<div class="section" id="while">
<h3><a class="toc-backref" href="#id35">while循环</a><a class="headerlink" href="#while" title="永久链接至标题">¶</a></h3>
</div>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id36">函数</a><a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p>通过上一章的 <a class="reference external" href="start.html#id3">简单的例子</a> ，我们在写第一个RapydScript程序时，已经学会了如何在RapydScript中定义一个函数。下面我们要介绍一些更多有关RapydScript函数的知识。</p>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id37">匿名函数</a><a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>与JavaScript一样，RapydScript运行我们使用匿名的函数。实际上，我们已经在前面的章节见到过（参见 <a class="reference external" href="start.html#id5">向外部API传递对象参数</a> ），当时我们创建了一个字典的字面对象，并且直接书写代码将匿名函数赋给 &#8216;onmouseover&#8217; 和 &#8216;onmouseout&#8217;。这看起来与Python的 lambda函数很相似，不过它的语法不像lamdba那样不方便，它并限制函数的所有代码必须写在一行中。下面是两种函数定义的方式，它们实际是等价的：</p>
<div class="highlight-python"><div class="highlight"><pre>def factorial(n):
    if n == 0:
        return 1
    return n * factorial(n-1)

factorial = def(n):
    if n == 0:
        return 1
    return n * factorial(n-1)
</pre></div>
</div>
<p>也许现在一开始还看不出有什么好处。如果放到Python中，上面这段代码还会显得有点怪，因为它不能明显表示这种函数是要被拷贝或者分配给其它对象的。但是，如果你熟悉JavaScript的话，你就知道这对程序员来说，这种语法是很有用的，特别是在处理嵌套函数的时候。</p>
<p>为了证明这种语法确实有用，下面我们来定义一个函数，用于创建并返回一个页面div元素。在用户按下鼠标不放的过程中，这个元素将会改变一个颜色。</p>
<div class="highlight-python"><div class="highlight"><pre>def makeDivThatTurnsGreen():
    div = $(&#39;&lt;div&gt;&lt;/div&gt;&#39;)

    turnGreen = def(event):
        div.css(&#39;background&#39;, &#39;green&#39;)

    div.mousedown(turnGreen)

    resetColor = def(event):
        div.css(&#39;background&#39;, &#39;&#39;)

    div.mouseup(resetColor)

    return div
</pre></div>
</div>
<p>也许第一眼看上去，匿名函数的好处还是不够明显。我们也可以创建一个匿名函数，然后分配给变量，这种方法替代方式也可以很容易做到上面的事。尽管如此，使用匿名函数最重要的是可以帮助我们迅速地表明意图：这些函数是用于将其绑定到另外的对象，既不是创建它们的主函数，也不是触发它们的逻辑，在我们的例子中，它们属于一个div对象。匿名函数最为有用的应用场景是：在一个匿名函数当前所在的对象中，创建一个在其它函数或对象中使用的元素，并且不会与当前代码混淆。</p>
<p>下面，我们可以借助 jQuery 的 $(document).ready() 方法（参见 <a class="reference external" href="start.html#jquery">调用jQuery</a> ），将这个自定义的div元素添加到一个页面元素中。$(document).ready() 接受一个函数作为参数，并且在页面加载完毕时对其进行调用。由于与函数名无关，因此通常传递一个匿名函数。用RapydScipt编写这段代码如下：</p>
<div class="highlight-python"><div class="highlight"><pre>$(document).ready(
        def(): $(&quot;#display&quot;).append(makeDivThatTurnsGreen());
    );
</pre></div>
</div>
<p>此外，正如你在前面章节见到的，匿名函数可以用于避免创建过多的临时变量，从而让代码更简洁：</p>
<div class="highlight-python"><div class="highlight"><pre>math_ops = {
    add:    def(a, b): return a+b;,
    sub:    def(a, b): return a-b;,
    mul:    def(a, b): return a*b;,
    div:    def(a, b): return a/b;,
    roots:  def(a, b, c):
        r = Math.sqrt(b*b - 4*a*c)
        d = 2*a
        return (-b + r)/d, (-b - r)/d
}
</pre></div>
</div>
<p>我肯定你一定同意上面的代码绝对要比先分别声明5个临时变量，然后再将它们分配给5个关键字所代表的对象要简单得多。</p>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id38">内联函数</a><a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>你应该注意到，在上面的这个例子中，将函数定义的头部（即def()）和函数体放在了同一行。我们将其称为内联函数。它是RapydScript中，一种可以简化代码的特性。尽管使用 <tt class="docutils literal"><span class="pre">;</span></tt> 可以把多条函数语句链接起来，构成一个更长的函数。但是，还是最好问问自己是否有必要将所有语句都写在同一行中，这是一条很好的经验法则。一般来说，如果分号超过2个，答案往往是否定的。</p>
<div class="line-block">
<div class="line"><strong>注：</strong> 在上一节的 <a class="reference external" href="start.html#id5">params对象的例子</a> 中可以看到，在非内联函数中也可以使用分号来作为新行的分隔符。</div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id39">参数魔法</a><a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<div class="section" id="id11">
<h4><a class="toc-backref" href="#id40">函数可选参数</a><a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h4>
<div class="line-block">
<div class="line"><strong>注：</strong> 可选参数（或者缺省参数）是指如果在调用函数时不为其传递值，该参数将获得它定义时所给的缺省值。可选参数的定义时使用了传递 <a class="reference external" href="grammar.html#kwargs">关键字参数</a> 的方式。</div>
<div class="line"><br /></div>
</div>
<p>与Python一样，JavaScript的函数参数支持可选参数。不过，JavaScript与Python不同的是，如果给函数的参数分配默认值，是不起作用的。如果你忘记给一个参数传值，JavaScript只是简单的将参数变量的值设为 undefined，怎么处理则完全交给你。如果你忘记处理，此后遇到任何类型的算术计算，你都会为此付出代价。那时，你将会最终会得到 NaN（而不是数字）、无限值或者其它奇怪的值，以及引发一个几百行由此导致的错误报告（祝你调试顺利）。</p>
<p>幸运的是，RapydScript允许使用更为理智的可选参数，它与Python极为相似。例如下面的例子中，允许你向函数参数color传入一个表示背景颜色的参数值，或者使用缺省的参数值的black（格式是 [r,g,b,a]）。</p>
<div class="highlight-python"><div class="highlight"><pre>def setColor(color=[0,0,0,1]):
    $(&#39;body&#39;).css(&#39;background&#39;, &#39;rgba(&#39;+&#39;,&#39;.join(color)+&#39;)&#39;)
</pre></div>
</div>
<p>这里有一点需要注意，与Python略有不同的是，RapydScript会在每次调用函数的时候，都重新穿件一个单独的局部变量对象来保存函数可选参数的默认值。这使得RapydScript在这方面不是那么高效，但是可以避免扰乱现有的对象。</p>
<div class="line-block">
<div class="line"><strong>注：</strong> 在实际的Python中，可选参数的默认值可以为一个可以调用的外部函数，函数仅在第一次执行时对可选参数进行求值。以后即使可选参数默认的外部函数返回值或代码逻辑有所改变，外部函数也不会得到重新执行，函数只会重复使用默认参数第一次传入的值。</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="def-func-args">
<h4><a class="toc-backref" href="#id41">变长参数列表 (<tt class="docutils literal"><span class="pre">def</span> <span class="pre">func(*args)</span></tt>)</a><a class="headerlink" href="#def-func-args" title="永久链接至标题">¶</a></h4>
<p>RapydScript的函数定义支持采用一种特殊的形式定义函数的参数，从而允许用户在调用函数时，向其传递任意数量的参数，这是Python中一种对个数变化的参数值进行收集的魔法。</p>
<p>虽然与Python一样，JavaScript也允许编写参数个数可变的函数，并有在此之上有自己完整实现逻辑。比如，在JavaScript中利用了这个特性的 Math.max() 、 console.log() 以及 数组的 concat() 方法等。然而，JavaScript并不像Python，它提供的支持并不直观。你必须在函数中使用一个特殊的可迭代元素，叫做 <tt class="docutils literal"><span class="pre">arguments</span></tt>，它具有数组的一些属性但没有支持数组的所有功能。因此，在函数调用中，如果你想要把数组展开为一个参数列表供函数使用，你必须使用 <tt class="docutils literal"><span class="pre">.apply</span></tt> 方法，而不是用一般的方式调用这个函数。</p>
<p>现在，RapydScript实现了将Python风格的 <tt class="docutils literal"><span class="pre">*args</span></tt> 方式转换为JavaScript。比如，下面定义的函数接受两个参数a、b，并且把传递进来的余下参数值包装成一个列表（虽然实际转换的JavaScript代码是用一个数组实现，但不是JavaScript那样用一个蹩脚的 <tt class="docutils literal"><span class="pre">arguments</span></tt> 对象。）：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">doSomething</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> <tt class="docutils literal"><span class="pre">*args</span></tt> 它表示 args 接收到的是余下任意个数参数值组成的列表。比如 doSomething(a, b, c, d)，甚至更多的值。你也可以在别处预先定义一个列表 args_list = (c, d) 或 args_list = [c, d]，然后使用doSomething(a, b, <a href="#id12"><span class="problematic" id="id13">*</span></a>args_list)的方式调用。</div>
<div class="line"><br /></div>
<div class="line">虽然，与Python有些不同，RapydScript不是采用元组来打包余下的参数，但对我们的要实现功能没有影响。</div>
<div class="line"><br /></div>
<div class="line">更多变长知识可以参考 <a class="reference external" href="http://www.pythondoc.com/pythontutorial27/controlflow.html#tut-arbitraryargs">《python官方文档中文版》</a> ，或者w3cschool的 <a class="reference external" href="http://www.w3cschool.cc/python/python-functions.html">《python基础教程》</a> 。</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="func-args-list">
<h4><a class="toc-backref" href="#id42">分配参数 (<tt class="docutils literal"><span class="pre">func(*args_list)</span></tt>)</a><a class="headerlink" href="#func-args-list" title="永久链接至标题">¶</a></h4>
<p>反过来，在类似下面的函数调用中，则会将一个包装成元组或列表的多个变量（实际是一个数组）解包为独立的参数值，并依次传递给函数的多个非关键字参数或一个变长的魔法参数。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">doSomethingElse</span><span class="p">(</span><span class="o">*</span><span class="n">args_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 函数doSomethingElse参数列表除了定义成 def doSomethingElse(<a href="#id14"><span class="problematic" id="id15">*</span></a>args)，还可以定义为普通的函数形式 def doSomethingElse(a, b, c, d) 。</div>
<div class="line"><br /></div>
<div class="line">它们都可以采用上面的调用方式。然而，定义方式取决于你在编写 doSomethingElse() 时，你是否真的知道函数的具体有哪些参数。不过，这种调用的方式最适用的情况还是函数定义时也采用变长的魔法参数时候。</div>
<div class="line"><br /></div>
</div>
<p>所以，当你得到一个由多个元素组成的列表，并且不知道列表的具体长度时，这种方式非常有用。</p>
<p>下面的例子中，print函数（内建全局函数，内部调用的是console.log方法）本身接受变长参数，下面是两种等价的调用打印函数print的方式：</p>
<div class="highlight-python"><div class="highlight"><pre># 普通方式
a = &#39;I was here&#39;
b = &#39;and there&#39;
print(a, b)

# 解包列表进行分配方式
a = &#39;I was here&#39;
b = &#39;and there&#39;
args_list = [a, b]
print(*argslist)
</pre></div>
</div>
<p>在这个例子中，我们还不能完全看出是用 * 操作符的好处。但是，如果 <tt class="docutils literal"><span class="pre">args_list</span></tt> 的值是来自外部（比如来自其它函数执行的结果），我们很有可能不知道它的长度。那么， * 操作符将会非常方便。</p>
</div>
<div class="section" id="kwargs">
<h4><a class="toc-backref" href="#id43">关键字参数(<tt class="docutils literal"><span class="pre">**kwargs</span></tt>)</a><a class="headerlink" href="#kwargs" title="永久链接至标题">¶</a></h4>
<div class="line-block">
<div class="line"><strong>注：</strong> 关键字参数 （Keyword Arguments）：是相较于位置参数而言的，它解决了在调用函数时，必须按参数位置传递参数值的问题。位置参数、关键字参数、可选参数、列表解包都是参数传递的方式（此外，Python还有将多余关键字参数传递给 <cite>**kwargs`</cite> 收集的方式，但RapydScript还不支持）。</div>
<div class="line"><br /></div>
<div class="line">因为传递参数时使用了参数的名字，因此关键字参数有时也被称为命名参数。</div>
<div class="line"><br /></div>
<div class="line">位置参数和关键字参数（命名参数）是可以联合使用的。但是，除非你很确定有这个必要，否则应避免混合使用。一般来说，位置参数一般是强制要求用户传递的参数。</div>
<div class="line"><br /></div>
<div class="line">前面已经看到，关键字参数在定义函数的 <a class="reference external" href="grammar.html#id11">可选参数</a> 时直接使用到。</div>
<div class="line"><br /></div>
</div>
<p>RapydScript所支持的关键字参数与Python不是完全的一致（没有实现 ** 操作符，它在Python中用于收集传递的参数值列表中剩余的关键字参数）。这是出于减小性能开销的考虑。因为你编写的函数99%不需要这个特性。</p>
<p>首先，让我来看一下RapydScript中函数调用的两种等价方式：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">test</span><span class="p">(</span><span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test</span><span class="p">(</span><span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="p">{</span><span class="n">foo</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bar</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 实际上Python与此有不同，Pyhton是不允许在用命名参数的传递方式之后再用非命名参数方式传递普通参数，否则会报错，但RapydScript没有如此严格。</div>
<div class="line"><br /></div>
<div class="line">尽管如此，更符合Python风格的好习惯是按照下面的普通参数、关键字参数、哈希列表（字典）的顺序传递参数，比如:  test( &#8216;baz&#8217;, bar=99, {foo: 1, bar: 3} )</div>
<div class="line"><br /></div>
</div>
<p>对于已经熟悉Python的人，可能容易体会这种调用方式的方便之处。</p>
<p>但就两种方式本身来说，它们都会首先在对命名参数（关键字参数）进行收集，然后将其放进一个哈希表（字典）中，并将哈希表传递给函数的最后一个参数（最后，会把剩下的参数按位置分配）。这也就是说，除非你的函数明显知道（其实是要你自己清楚这一点）收集的命名参数的哈希表位于最后一个参数中。否则，RapydScript普通函数是不能自己确定最后一个参数是什么的。</p>
<p>我们来看一个例子，函数的定义如下，可以看一下在上面的调用后，它的每个参数取得的值：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">kw</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>  <span class="c"># &#39;baz&#39;</span>
    <span class="k">print</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>  <span class="c"># 99</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>   <span class="c"># {foo: 1. bar: 3}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">])</span>   <span class="c"># 1</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 我们先记住RapydScript有这样的收集约定，不过只是这样收集起来，还不能实现Python中关键字参数最重要的特性。关键字参数最为重要的用途是可以在传递参数时不用考虑参数的位置，</div>
<div class="line"><br /></div>
</div>
<p>幸运地是，RapydScript有一个 <tt class="docutils literal"><span class="pre">kwargs</span></tt> 函数修饰符，可以模仿Python中传递关键字参数时忽略参数实际位置的特性。比如：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_kwargs</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">kw</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>  <span class="c"># 1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>  <span class="c"># 3</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>   <span class="c"># {foo: 1. bar: 3}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">])</span>   <span class="c"># 1</span>

<span class="c"># works:</span>
<span class="n">test_kwargs</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="p">{</span><span class="n">foo</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bar</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id44">函数修饰符</a><a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p>是的，和Python一样，RapydScript支持函数修饰符，只不过目前函数修饰符还不能接受参数。尽管如此，基本修饰符的功能与在Python中的修饰符是几乎一样的：</p>
<div class="line-block">
<div class="line"><strong>注：</strong> 从实现上讲，修饰符其实就是一个以函数为参数的函数。并且，在它内部嵌套了一个加入了新的逻辑的函数，并将其返回后用来替代被装饰的原函数。一般为了保证原函数的逻辑被执行，在嵌套的函数中会对原函数进行一次调用。</div>
<div class="line"><br /></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># 利用函数嵌套定义修饰符</span>
<span class="k">def</span> <span class="nf">makebold</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapped</span><span class="p">():</span>
        <span class="k">return</span> <span class="s">&quot;&lt;b&gt;&quot;</span> <span class="o">+</span> <span class="n">fn</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;&lt;/b&gt;&quot;</span>
    <span class="k">return</span> <span class="n">wrapped</span>

<span class="k">def</span> <span class="nf">makeitalic</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapped</span><span class="p">():</span>
        <span class="k">return</span> <span class="s">&quot;&lt;i&gt;&quot;</span> <span class="o">+</span> <span class="n">fn</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;&lt;/i&gt;&quot;</span>
    <span class="k">return</span> <span class="n">wrapped</span>

<span class="c"># 使用修饰符</span>
<span class="nd">@makebold</span>
<span class="nd">@makeitalic</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&quot;hello world&quot;</span>

<span class="n">hello</span><span class="p">()</span> <span class="c"># returns &quot;&lt;b&gt;&lt;i&gt;hello world&lt;/i&gt;&lt;/b&gt;&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 函数修饰符是Python中的一种常用的语法。上例中在调用函数hello()时，其实相当于执行了 makebold( makeitalic( hello()) ，这其实是面向对象编程中的装饰器模式的语法支持。</div>
<div class="line"><br /></div>
<div class="line">更多关于Python函数修饰符的知识可以参考 <a class="reference external" href="https://docs.python.org/2/whatsnew/2.4.html?highlight=decorator#pep-318-decorators-for-functions-and-methods">Python官方文档</a> ，或者  <a class="reference external" href="http://wiki.woodpecker.org.cn/moin/WeiZhong/DecoratorsInPython24">有关中文文档</a> 。</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="id17">
<h2><a class="toc-backref" href="#id45">其它惯用法</a><a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h2>
<div class="section" id="id18">
<h3><a class="toc-backref" href="#id46">列表的操作</a><a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h3>
<p>RapydScript在许多时候，与许多地方允许你同时使用Python风格和JavaScript风格的方法名。例如，向一个数组追加一个元素，既可以使用 <tt class="docutils literal"><span class="pre">push()</span></tt> ，也可以使用 <tt class="docutils literal"><span class="pre">append()</span></tt>：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">arr</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="c"># outputs [2,4]</span>
</pre></div>
</div>
<p>但为了能使用Python风格的方法，你还是需要包含RapydSript的stdlib.js文件。你有两种方式可以采用，一种是将下面的文件添加到html页面中：</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;script type=&quot;text/javascript&quot; src=&#39;stdlib.js&#39;&gt;&lt;/script&gt;
</pre></div>
</div>
<p>另一种方式是在RapydScript文件的头部包含下面的一行代码：</p>
<div class="highlight-html"><div class="highlight"><pre>import stdlib
</pre></div>
</div>
<p>第二种方法的优点是，你不需要手动拷贝stdlib.js库到你JavaScript目录中，它会自动加入代码到RapydScript转换的JavaScript代码中。尽管如此，当你有多个独立编译地RapydScript程序时，第一种方法还是非常有有用的，它可以避免每个文件中都包含相同的stdlib代码。</p>
<p>为了模仿类似python的方法，我将一部分的JavaScript本身的方法做了变化。比如，重写后的array.pop()的工作方式就与Python的pop()（或JavaScript的splice()）相似。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">arr</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>       <span class="c"># 移除最后一个元素 (JavaScript和Python均有的行为)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c"># 移除第3个元素 (Python中预期的行为, 但JavaScript没有)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">splice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c"># removes third element (JavaScript中有的行为, 但Python没有)</span>
</pre></div>
</div>
<p>上面最后两行代码还略微有些不同，arr.pop(2)返回的是一个元素，而arr.splice(2,1)返回的是一个只包含一个元素的数组。</p>
</div>
<div class="section" id="id19">
<h3><a class="toc-backref" href="#id47">关键字</a><a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<p>RapydScript中的关键字，大多数可以与JavaScript进行互换的：</p>
<div class="highlight-python"><div class="highlight"><pre>RapydScript     JavaScript

None/null       null
False/false     false
True/true       true
undefined       undefined
this            this
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h3><a class="toc-backref" href="#id48">操作符</a><a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h3>
<p>在RapydScript中不支持JavaScript的操作符，你可以使用它们的Python版本。下面是一个用法对照表：</p>
<div class="highlight-python"><div class="highlight"><pre>RapydScript     JavaScript

and             &amp;&amp;
or              ||
not             !
is              ===
is not          !==
+=1             ++
-=1             --
**              Math.pow()
</pre></div>
</div>
<p>虽然说，JavaScript中的 <tt class="docutils literal"><span class="pre">===</span></tt> 与Python中 <a href="#id21"><span class="problematic" id="id22">``</span></a>is``不是完全一样。但是，JavaScript在比较两个对象时还是比较特殊（两边值类型不同时不做转换）。</p>
<p>所以，你可能还会需要 <tt class="docutils literal"><span class="pre">stdlib</span></tt> 中 <tt class="docutils literal"><span class="pre">deep_eq</span></tt> 这样的函数，它可以对两个对象进行深层次的比较测试，并且在所有的类型上都可以工作，包括哈希表和数组</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">deep_eq</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>     <span class="c"># False</span>
<span class="n">deep_eq</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>   <span class="c"># False</span>
<span class="n">deep_eq</span><span class="p">([</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>   <span class="c"># True</span>
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h3><a class="toc-backref" href="#id49">三元条件表达式</a><a class="headerlink" href="#id23" title="永久链接至标题">¶</a></h3>
<p>关于条件表达式话题争论了很长时间。在Python中，如果你想要在行内根据一个条件对变量进行赋值，那么你可以像下面这样写一个条件表达式的的语句：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">foo</span> <span class="o">=</span> <span class="s">&quot;bar&quot;</span> <span class="k">if</span> <span class="n">baz</span> <span class="k">else</span> <span class="mi">10</span>
</pre></div>
</div>
<p>在JavaScript中，下面的代码具有相同的逻辑：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">baz</span> <span class="o">?</span> <span class="s2">&quot;bar&quot;</span> <span class="o">:</span> <span class="mi">10</span>
</pre></div>
</div>
<p>究竟哪种更加简洁一点，取决于个人的喜好（在大多数的 <tt class="docutils literal"><span class="pre">if</span></tt> 语句中，我喜欢首先见到的是条件，所以第二种方式对我更有用一点）。不过，第二种方式更胜一筹的地方是处理匿名函数的时候。实际上，Python不需要去处理这种情况，但RapydScirpt有时是需要的。因此，我决定在RapydScript中引入JavaScript的方式，使你可以使用与JavaScript类似的方式分配匿名函数：</p>
<div class="highlight-python"><div class="highlight"><pre>foo = baz ? def(): return bar; : def(): return 10
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 在Python和JavaScript中都有一个有趣的特性：短路逻辑（short-circuit logic）或者惰性求值（lazy evaluation）,它在一系列的布尔表达式中，仅计算最少的表达式来确定整个链的布尔值，从而避免无用地执行代码。三元条件表达式也有这个特性。</div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="id24">
<h3><a class="toc-backref" href="#id50">链式代码块</a><a class="headerlink" href="#id24" title="永久链接至标题">¶</a></h3>
<p>如果在使用RapydScript的时候，还需要想办法处理一些JavaScript可以轻松处理的事情，那么RapydScript不会好用的。</p>
<div class="section" id="javascript">
<h4><a class="toc-backref" href="#id51">JavaScript风格链式操作</a><a class="headerlink" href="#javascript" title="永久链接至标题">¶</a></h4>
<p>如果你曾使用过JavaScript或者jQuery，那么你一定见过下面的语法：</p>
<div class="highlight-python"><div class="highlight"><pre>function(){
    // some logic here
}.call(this);
</pre></div>
</div>
<p>这段代码将会在定义之后立即执行，而不是等到将其分配给一个变量。但是，Python是完全不支持这种语法的，最为接近的可能就是：</p>
<div class="highlight-python"><div class="highlight"><pre>def tmp():
    # some logic here
tmp.__call__()
</pre></div>
</div>
<p>虽然这不是那么差劲，但是我们还是在我们的命名空间中引入了一个临时变量。如果我们需要反复地做样的事，这样的方式会比较烦人的。正因如此，RapydScript打算做一些对于Python来说不太正统的事情，它实现了类似JavaScript的解决方案：</p>
<div class="highlight-python"><div class="highlight"><pre>def():
    # some logic here
.call(this)
</pre></div>
</div>
<p>RapydScript 会将任何以``.``开头的语句行与正确缩进的整个代码块进行绑定。这中方式不只仅限与 <tt class="docutils literal"><span class="pre">.call()</span></tt> 方法，你还可以使用 <tt class="docutils literal"><span class="pre">.apply()</span></tt> 或者其它可以函数的方法和属性。比如，在jQuery中可以这样使用：</p>
<div class="highlight-python"><div class="highlight"><pre>$(element)
.css(&#39;background-color&#39;, &#39;red&#39;)
.show()
</pre></div>
</div>
<p>这中方式中有一个唯一的使用限制，如果你喜欢在链式调用中采用缩进，你仍然可以像下面这样使用 <tt class="docutils literal"><span class="pre">\</span></tt> 分隔符：</p>
<div class="highlight-python"><div class="highlight"><pre>$(element)\
    .css(&#39;background-color&#39;, &#39;red&#39;)\
    .show()
</pre></div>
</div>
</div>
<div class="section" id="python">
<h4><a class="toc-backref" href="#id52">Python风格链式操作</a><a class="headerlink" href="#python" title="永久链接至标题">¶</a></h4>
<p>RapydScript实际还支持另一种替代语法，可以实现相同的功能。这种语法适合哪些习惯Python传统的人，它的代码外观是悬挂式缩进的：</p>
<div class="highlight-python"><div class="highlight"><pre>def(one, two) and call(this, 1, 2):
    ...
</pre></div>
</div>
<p>这段代码与下面的代码是等价的：</p>
<div class="highlight-python"><div class="highlight"><pre>def(one, two):
    ...
.call(this, 1, 2)
</pre></div>
</div>
<p>也许有的人喜欢这个特性，而有的人则不会喜欢。RapydScript的目标总是希望让其独有的特性与普通的Python相比不会太过太突兀。从而使得假如你不认同RapydScript的这种特性，完全可以不使用它。</p>
</div>
<div class="section" id="id25">
<h4><a class="toc-backref" href="#id53">while循环的增强特性</a><a class="headerlink" href="#id25" title="永久链接至标题">¶</a></h4>
<p>最近，do/while循环也增强了类似的链式操作特性：</p>
<div class="highlight-python"><div class="highlight"><pre>a = 0
do:
    print(a)
    a += 1
.while a &lt; 1
</pre></div>
</div>
<p>在我看来，Python其实也可以吸收一下这种语法的好处。与函数一样，你也可以使用悬挂缩进的形式：</p>
<div class="highlight-python"><div class="highlight"><pre>a = 0
do and while a &lt; 1:
    print(a)
    a += 1
</pre></div>
</div>
</div>
</div>
<div class="section" id="print">
<h3><a class="toc-backref" href="#id54">输出语句print()</a><a class="headerlink" href="#print" title="永久链接至标题">¶</a></h3>
<p>最后，我们要介绍的就是 <tt class="docutils literal"><span class="pre">print()</span></tt> 与 <tt class="docutils literal"><span class="pre">console.log()</span></tt> 的差别。 <tt class="docutils literal"><span class="pre">print()</span></tt> 方法定义在RapydScript的stdlib库中，被设计用来模仿Python中的Print语句。 <tt class="docutils literal"><span class="pre">console.log()</span></tt> 是JavaScript版本的debug输出方法，它更加强大。但是如果只是想要快速输出，它则显得有点不方便。下面是一个例子：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>          <span class="c"># [1,2,3,4]</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>    <span class="c"># [1,2,3,4]</span>

<span class="n">arr2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="k">print</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>         <span class="c"># [[1,2],[3,4]]</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>   <span class="c"># [Array[2], Array[2]]</span>

<span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;dogs&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;cats&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>         <span class="c"># {&quot;dogs&quot;:1,&quot;cats&quot;:2}</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>   <span class="c"># Object</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="js">
<h2><a class="toc-backref" href="#id55">嵌入JS代码</a><a class="headerlink" href="#js" title="永久链接至标题">¶</a></h2>
<p>在少数情况下，RapydScript可能没有办法让你做想做的事，那么此时你可以使用纯JavaScript代码。</p>
<p>这种情况下，你可以将JavaScript代码包括在一个字符串中，并且传递给 JS() 方法。不过，JS()方法并不是一个沙箱，其中的代码可以与普通的RapydScript代码进行交互：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">JS</span><span class="p">(</span><span class="s">&#39;a = {foo: &quot;bar&quot;, baz: 1};&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>    <span class="c"># prints &quot;bar&quot;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>注：</strong> 多行的代码可以使用多行字符串，即使用三引号 <cite>&#8220;&#8221;&#8220;</cite> 。</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="class.html" class="btn btn-neutral float-right" title="类"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="start.html" class="btn btn-neutral" title="开始编程"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 2015, adousen.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>